<script th:inline="javascript">
  function usecategory2Controller($scope, $http) {
    //Error
    $scope.isShowFirstNameError = useIsShowError($scope, $http, "firstName");
    $scope.isShowNickNameError = useIsShowError($scope, $http, "nickName");
    $scope.isShowPhoneError = useIsShowError($scope, $http, "phone");
    $scope.isShowOldError = useIsShowError($scope, $http, "old");
    $scope.isShowLocationError = useIsShowError($scope, $http, "location");
    $scope.isShowLineError = useIsShowError($scope, $http, "line");
    $scope.isShowFacebookError = useIsShowError($scope, $http, "facebook");
    $scope.isShowNationalityError = useIsShowError(
      $scope,
      $http,
      "nationality"
    );
    $scope.isShowEthnicityError = useIsShowError($scope, $http, "ethnicity");
    $scope.isShowLineIdError = useIsShowError($scope, $http, "lineID");
    $scope.isShowWishesError = useIsShowError($scope, $http, "wishes");
    //Error selected
    $scope.isShowTypeNameError = useIsShowSelectError(
      $scope,
      $http,
      "typeName"
    );
    $scope.isShowIndtypeError = useIsShowSelectError($scope, $http, "indtype");
    $scope.isShowSickError = useIsShowSelectError($scope, $http, "sick");

    //Save
    $scope.requestSave = useRequestSave($scope, $http);
    $scope.verify = useVerify($scope, $http);

  }

  function useIsShowError($scope, $http, fieldName) {
    return () => {
      if ($scope.employeeForm[fieldName]) {
        return (
          ($scope.employeeForm.$submitted ||
            $scope.employeeForm[fieldName].$dirty) &&
          $scope.employeeForm[fieldName].$invalid
        );
      }
      return false;
    };
  }

  function useIsShowSelectError($scope, $http, fieldName) {
    return () => {
      if ($scope.employeeForm[fieldName]) {
        return (
          $scope.employeeForm.$submitted &&
          $scope.employeeForm[fieldName].$invalid
        );
      }
    };
  }

  function useVerify($scope, $http) {
    return () => {
        if($scope.isShowDriveError != true){
            return $scope.employeeForm.$valid;
        }
    };
  }

  function useRequestSave($scope, $http) {
    return () => {
      console.log("Save");
      console.log($scope.criteria);
      console.log($scope.isShowDriveError);
      console.log($scope.selectedEmployeeProfile);
      $scope.employeeForm.$submitted = true;

      if ($scope.verify()) {
        const options = {
          title:
            $scope.entryMode === "add"
              ? "ยืนยันการบันทึกข้อมูลครู ?"
              : "ยืนยันการแก้ไขข้อมูลครู",
          text: 'กดปุ่ม "ตกลง" เพื่อยืนยัน',
          icon: "warning",
          buttons: ["ยกเลิก", "ตกลง"],
          dangerMode: true,
        };

        const handler = (confirm) => {
          if (confirm) {
            // $scope.setupTeacherSubjectMapper($scope.selectedTeacherProfile);
            console.log($scope.selectedEmployeeProfile);
          }
        };

        swal(options).then(handler);
      } else {
        swal("ข้อมูลไม่ครบถ้วน", "กรุณาระบุข้อมูลให้ครบถ้วน", "error");
      }
    };
  }
</script>
